<!--  This Source Code Form is subject to the terms of the MIT license
      If a copy of the MIT license was not distributed with this file, you can
      obtain one at http://www.mozillapopcorn.org/butter-license.txt -->

<html>
  <head>
    <script type="text/javascript" src="../src/dialog/dialog-comm.js"></script>
    <script type="text/javascript">
      (function(){
        var _comm = new Comm();

        document.addEventListener( "DOMContentLoaded", function( e ){
          var okButton = document.getElementById( "yes" ),
              cancelButton = document.getElementById( "no" ),
              nameInput = document.getElementById( "name-input" );

          function okPressed( e ){
            if( nameInput.value.replace( /\s/g, "" ) !== "" ){
              _comm.send( "submit", nameInput.value );  
            }
            else{
              document.getElementById( "better" ).style.display = "inline";
            }
            
          } //okPressed

          function cancelPressed( e ){
            _comm.send( "cancel" );
          } //cancelPressed

          document.addEventListener( "keypress", function( e ) {
            if( e.keyCode === 13 ) {
              okPressed( e );
            } else if( e.keyCode === 27 ) {
              cancelPressed( e );
            }
          }, false);

          _comm.listen( "name", function( e ){
            nameInput.value = e.data || "";
            okButton.removeAttribute( "disabled" );
            cancelButton.removeAttribute( "disabled" );
          });

          okButton.addEventListener( "click", okPressed, false );
          cancelButton.addEventListener( "click", cancelPressed, false );

        }, false );
      }());
    </script>
    <link rel="stylesheet" href="dialog.css" />
    <style>
      #better {
        display: none;
        color: #fb1121;
      }
      #name-input {
        width: 100%;
      }
    </style>
  </head>
  <body>
    <div id="container" class="hbox center">
      <div class="vbox center">
        <h1>Please give your project a<span id="better"> better</span> name:</h1>
        <input type="text" id="name-input" />
        <div id="buttons" class="hbox center">
          <button disabled id="yes">Ok</button>
          <button disabled id="no">Cancel</button>
        </div>
      </div>
    </div>
  </body>
</html>
